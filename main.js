(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],[,,,,,,,,,,,function(e,a,t){e.exports=t(32)},,,,,function(e,a,t){},,,,,,,,,function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),o=t(8),c=t.n(o),l=(t(16),t(6)),i=t(1),s=t(2),m=t(4),u=t(3),p=t(5),d=t(9),f=(t(25),function(e){var a=e.markers,t=a[0]?a[0].location:[],n=a.map((function(e){return{center:e.location,option:{strokeThickness:2,fillColor:"rgba(0, 255, 0, 0.5)",strokeColor:"red"},radius:20,points:a.length}}));return r.a.createElement(d.ReactBingmaps,{bingmapKey:"Av6TwAZf98VQOYxo8vawIe-9l7TAsmPM2ZZ7WQsl92MtX_nyywvFiLfnsuQ4WFWt",className:"map",center:t,pushPins:a,regularPolygons:n})}),h=(t(26),function(e){var a=e.marker,t=e.onClick;return r.a.createElement("div",{className:"marker"},r.a.createElement("p",null,a.location[0],", ",a.location[1]),r.a.createElement("button",{onClick:function(){return t(a)}},"\xd7"))}),k=(t(27),function(e){var a=e.markers,t=e.deleteMarker;return r.a.createElement("div",{className:"markers-list"},!!a.length&&r.a.createElement("p",null,"Coordinates list"),a.map((function(e){return r.a.createElement(h,{key:e.id,onClick:t,marker:e})})))}),v=t(10),g=t.n(v),N=(t(28),function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=Object(m.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(r)))).state={type:"cords"},t.onTypeChange=function(e){t.setState({type:e.target.id})},t.onSubmitCords=function(){var e={location:[Number(t.lat.value),Number(t.lng.value)],id:g()()};t.lat.value="",t.lng.value="",t.props.addMarker(e)},t}return Object(p.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"marker-form"},r.a.createElement("h3",null,"Coordinates Form"),r.a.createElement("div",{className:"type-selection"},r.a.createElement("div",null,r.a.createElement("input",{type:"radio",id:"cords",name:"marker",value:"cords",onChange:this.onTypeChange,checked:"cords"===this.state.type}),r.a.createElement("label",{for:"cords"},"Add by cords")),r.a.createElement("div",null,r.a.createElement("input",{type:"radio",id:"place",name:"marker",onChange:this.onTypeChange,value:"place",checked:"place"===this.state.type}),r.a.createElement("label",{for:"place"},"Add by place"))),"cords"===this.state.type&&r.a.createElement("div",{className:"cords"},r.a.createElement("div",{className:"input"},r.a.createElement("label",{for:"lat"},"lat:"),r.a.createElement("input",{className:"lat",id:"lat",ref:function(a){return e.lat=a}})),r.a.createElement("div",{className:"input"},r.a.createElement("label",{for:"lng"},"lng:"),r.a.createElement("input",{id:"lng",ref:function(a){return e.lng=a}})),r.a.createElement("button",{className:"cords-button button",onClick:this.onSubmitCords},"Submit cords")))}}]),a}(r.a.Component)),b=(t(29),function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=Object(m.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(r)))).onChangeMapName=function(e){(0,t.props.changeMapName)(e.target.value)},t}return Object(p.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this.props,a=e.mapName,t=e.onSaveClick,n="".concat(a," Map");return r.a.createElement("div",{className:"markers-header"},r.a.createElement("h2",null,n),r.a.createElement("div",{className:"map-name"},r.a.createElement("p",null,"Add Map Name: "),r.a.createElement("input",{type:"text",name:"name",value:a,onChange:this.onChangeMapName})),r.a.createElement("button",{className:"button",onClick:t},"Save"))}}]),a}(r.a.Component)),E=(t(30),function(e){var a=e.markers,t=e.addMarker,n=e.deleteMarker,o=e.changeMapName,c=e.mapName,l=e.onSaveClick;return r.a.createElement("div",{className:"markers-panel"},r.a.createElement(b,{onSaveClick:l,changeMapName:o,mapName:c}),r.a.createElement("div",null,r.a.createElement(N,{addMarker:t}),r.a.createElement(k,{markers:a,deleteMarker:n})))}),C=function(e){var a=e.mapName,t=e.markers,n=w(t);return new Promise((function(e,t){window.Visualforce.remoting.Manager.invokeAction(window.RemoteActions.CreateMap,a,n,(function(a,n){200===n.statusCode&&(a?e(a):(console.log("failed to create"),t(n)))}),{escape:!1})}))},M=function(e){var a=e.mapId,t=e.mapName,n=void 0===t?"":t,r=e.markersToDelete,o=void 0===r?null:r,c=e.markersToInsert,l=w(void 0===c?null:c),i=w(o);return new Promise((function(e,t){window.Visualforce.remoting.Manager.invokeAction(window.RemoteActions.UpdateMap,a,n,l,i,(function(a,n){200===n.statusCode?(a.success||(console.log("failed to update"),console.log(a.error),t(n)),e(a.success)):t(n)}),{escape:!1})}))},y=function(e){return new Promise((function(a,t){window.Visualforce.remoting.Manager.invokeAction(window.RemoteActions.GetMap,e,(function(e,n){if(200===n.statusCode){e||(console.log("failed to get"),t(n));var r=O(e.mapCords);a({map:e.map,markers:r})}else t(n)}),{escape:!1})}))},w=function(e){return e?e.map((function(e){return{Latitude:e.location[0],Longitude:e.location[1]}})):null},O=function(e){return e?e.map((function(e){return{location:[Number(e.Latitude__c),Number(e.Longitude__c)],id:e.Id}})):[]},j=(t(31),function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=Object(m.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(r)))).state={markers:[],mapName:"",mapId:""},t.componentDidMount=function(){var e=window.location.search,a=new URLSearchParams(e).get("MapId");a&&y(a).then((function(e){var a=e.markers,n=e.map;t.setState({markers:[].concat(Object(l.a)(t.state.markers),Object(l.a)(a)),mapId:n.Id,mapName:n.Name})})).catch((function(){return console.log("oops")}))},t.addMarker=function(e){var a=t.state.mapId;M({mapId:a,markersToInsert:[e]}).then((function(){return console.log("wow")})).catch((function(){return console.log("shit")})),t.setState({markers:[].concat(Object(l.a)(t.state.markers),[e])})},t.deleteMarker=function(e){var a=t.state,n=a.markers,r=a.mapId;if(n.length){var o=n.findIndex((function(a){return a.id===e.id})),c=n;c.splice(o,1),M({mapId:r,markersToDelete:[e]}).then((function(){t.setState({markers:c})})).catch((function(){return console.log("shit")}))}},t.changeMapName=function(e){return t.setState({mapName:e})},t.onSaveClick=function(){var e=t.state,a=e.markers,n=e.mapName,r=e.mapId;r?M({mapId:r,mapName:n}).then((function(){return console.log("wow")})).catch((function(){return console.log("shit")})):C({mapName:n,markers:a}).then((function(e){t.setState({mapId:e})})).catch((function(){return console.log("shit")}))},t}return Object(p.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this.state,a=e.markers,t=e.mapName;return r.a.createElement("div",{className:"app"},r.a.createElement(E,{markers:a,addMarker:this.addMarker,onSaveClick:this.onSaveClick,deleteMarker:this.deleteMarker,changeMapName:this.changeMapName,mapName:t}),r.a.createElement(f,{markers:a}))}}]),a}(r.a.Component));c.a.render(r.a.createElement(j,null),document.getElementById("root"))}],[[11,1,2]]]);
//# sourceMappingURL=main.94c9b1f8.chunk.js.map